!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.iro=e()}(this,function(){"use strict";var s="iro__marker",u=function(t,e){var r=t.g({class:s});r.circle(0,0,e.r,{class:s+"__outer",fill:"none",strokeWidth:5,stroke:"#000"}),r.circle(0,0,e.r,{class:s+"__inner",fill:"none",strokeWidth:2,stroke:"#fff"}),this.g=r};u.prototype.move=function(t,e){this.g.setTransform("translate",[t,e])};var c="iro__wheel",l=Math.PI,f=Math.sqrt,n=Math.abs,p=Math.round,y=function(t,e){this._opts=e,this.type="wheel";var r=e.cY,s=e.cX,i=e.r,n=e.border,o=t.g({class:c});o.circle(s,r,i+n.w/2,{class:c+"__border",fill:"#fff",stroke:n.color,strokeWidth:n.w});for(var a=o.g({class:c+"__hue",strokeWidth:i,fill:"none"}),h=0;h<360;h++)a.arc(s,r,i/2,h,h+1.5,{stroke:"hsl("+(e.anticlockwise?360-h:h)+",100%,50%)"});o.circle(s,r,i,{class:c+"__saturation"}).setGradient("fill",t.gradient("radial",{0:{color:"#fff"},100:{color:"#fff",opacity:0}})),this._lightness=o.circle(s,r,i,{class:c+"__lightness",opacity:0}),this.marker=new u(o,e.marker)};y.prototype.update=function(t,e){var r=this._opts,s=t.hsv;if(e.v&&r.lightness&&this._lightness.setAttrs({opacity:(1-s.v/100).toFixed(2)}),e.h||e.s){var i=(r.anticlockwise?360-s.h:s.h)*(l/180),n=s.s/100*r.rMax;this.marker.move(r.cX+n*Math.cos(i),r.cY+n*Math.sin(i))}},y.prototype.input=function(t,e){var r=this._opts,s=r.rMax,i=r.cX-t,n=r.cY-e,o=Math.atan2(n,i),a=p(o*(180/l))+180,h=Math.min(f(i*i+n*n),s);return{h:a=r.anticlockwise?360-a:a,s:p(100/s*h)}},y.prototype.checkHit=function(t,e){var r=this._opts,s=n(t-r.cX),i=n(e-r.cY);return f(s*s+i*i)<r.r};var v=Math.round,g=Math.floor;function r(t,e){var r=t.match(/(\S+)\((\d+)(%?)(?:\D+?)(\d+)(%?)(?:\D+?)(\d+)(%?)(?:\D+?)?([0-9\.]+?)?\)/i),s=parseInt(r[2]),i=parseInt(r[4]),n=parseInt(r[6]);return[r[1],"%"==r[3]?s/100*e[0]:s,"%"==r[5]?i/100*e[1]:i,"%"==r[7]?n/100*e[2]:n,parseFloat(r[8])||void 0]}function o(t){return t instanceof m?t:new m(t)}function a(t,e,r){return t<=e?e:r<=t?r:t}function i(t,e){var r={};for(var s in t)r[s]=e[s]!=t[s];return r}var m=function(t){this._onChange=!1,this._value={h:void 0,s:void 0,v:void 0},t&&this.set(t)},t={hsv:{configurable:!0},rgb:{configurable:!0},hsl:{configurable:!0},rgbString:{configurable:!0},hexString:{configurable:!0},hslString:{configurable:!0}};m.mix=function(t,e,r){var s=o(t).rgb,i=o(e).rgb;return r=a(r/100||.5,0,1),new m({r:g(s.r+(i.r-s.r)*r),g:g(s.g+(i.g-s.g)*r),b:g(s.b+(i.b-s.b)*r)})},m.lighten=function(t,e){var r=o(t),s=r.hsv;return s.v=a(s.v+e,0,100),r.hsv=s,r},m.darken=function(t,e){var r=o(t),s=r.hsv;return s.v=a(s.v-e,0,100),r.hsv=s,r},m.hsv2Rgb=function(t){var e,r,s,i,n,o,a,h,c=t.h/360,l=t.s/100,u=t.v/100;switch(o=u*(1-l),a=u*(1-(n=6*c-(i=g(6*c)))*l),h=u*(1-(1-n)*l),i%6){case 0:e=u,r=h,s=o;break;case 1:e=a,r=u,s=o;break;case 2:e=o,r=u,s=h;break;case 3:e=o,r=a,s=u;break;case 4:e=h,r=o,s=u;break;case 5:e=u,r=o,s=a}return{r:v(255*e),g:v(255*r),b:v(255*s)}},m.rgb2Hsv=function(t){var e,r=t.r/255,s=t.g/255,i=t.b/255,n=Math.max(r,s,i),o=Math.min(r,s,i),a=n-o;switch(n){case o:e=0;break;case r:e=(s-i)/a+(s<i?6:0);break;case s:e=(i-r)/a+2;break;case i:e=(r-s)/a+4}return{h:360*(e/=6),s:0==n?0:a/n*100,v:100*n}},m.hsv2Hsl=function(t){var e=t.s/100,r=t.v/100,s=.5*r*(2-e);return e=r*e/(1-Math.abs(2*s-1)),{h:t.h,s:100*e||0,l:100*s}},m.hsl2Hsv=function(t){var e=t.s/100,r=t.l/100;return e*=(r*=2)<=1?r:2-r,{h:t.h,s:2*e/(r+e)*100,v:(r+e)/2*100}},m.hsl2Str=function(t){return"hsl"+(t.a?"a":"")+"("+t.h+", "+t.s+"%, "+t.l+"%"+(t.a?", "+t.a:"")+")"},m.rgb2Str=function(t){return"rgb"+(t.a?"a":"")+"("+t.r+", "+t.g+", "+t.b+(t.a?", "+t.a:"")+")"},m.rgb2Hex=function(t){var e="#";return e+=t.r.toString(16).padStart(2,"0"),e+=t.g.toString(16).padStart(2,"0"),e+=t.b.toString(16).padStart(2,"0")},m.parseHexStr=function(t){t=t.replace("#","");var e=parseInt("0x"+t),r=3==t.length,s=r?15:255,i=r?4:8,n=r?17:1;return{r:(e>>2*i&s)*n,g:(e>>i&s)*n,b:(e&s)*n}},m.parseHslStr=function(t){var e=r(t,[360,100,100]);return{h:e[2],s:e[3],l:e[4]}},m.parseRgbStr=function(t){var e=r(t,[255,255,255]);return{r:e[1],g:e[2],b:e[3]}},t.hsv.get=function(){var t=this._value;return{h:t.h,s:t.s,v:t.v}},t.hsv.set=function(t){if(this._onChange){var e=this._value;for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r]);var s=i(e,t);this._value=t,(s.h||s.s||s.v)&&this._onChange(this,s)}else this._value=t},t.rgb.get=function(){var t=m.hsv2Rgb(this._value);return{r:v(t.r),g:v(t.g),b:v(t.b)}},t.rgb.set=function(t){this.hsv=m.rgb2Hsv(t)},t.hsl.get=function(){var t=m.hsv2Hsl(this._value);return{h:v(t.h),s:v(t.s),l:v(t.l)}},t.hsl.set=function(t){this.hsv=m.hsl2Hsv(t)},t.rgbString.get=function(){return m.rgb2Str(this.rgb)},t.rgbString.set=function(t){this.rgb=m.parseRgbStr(t)},t.hexString.get=function(){return m.rgb2Hex(this.rgb)},t.hexString.set=function(t){this.rgb=m.parseHexStr(t)},t.hslString.get=function(){return m.hsl2Str(this.hsl)},t.hslString.set=function(t){this.hsl=m.parseHslStr(t)},m.prototype.set=function(t){"object"==typeof t?t instanceof m?this.hsv=m.hsv:"r"in t?this.rgb=t:"v"in t?this.hsv=t:"l"in t&&(this.hsl=t):"string"==typeof t&&(/^rgb/.test(t)?this.rgbString=t:/^hsl/.test(t)?this.hslString=t:/^#[0-9A-Fa-f]/.test(t)&&(this.hexString=t))},m.prototype.setChannel=function(t,e,r){var s=this[t];s[e]=r,this[t]=s},m.prototype.clone=function(){return new m(this)},m.prototype.compare=function(t,e){return i(this[e=e||"hsv"],o(t)[e])},m.prototype.mix=function(t,e){this.hsv=mix(this,t,e).hsv},m.prototype.lighten=function(t){lighten(this,t)},m.prototype.darken=function(t){darken(this,t)},Object.defineProperties(m.prototype,t);var d="iro__slider",b=function(t,e){var r=e.r,s=e.w,i=e.h,n=e.x,o=e.y,a=e.border.w;e.range={min:n+r,max:n+s-r,w:s-2*r},e.sliderType=e.sliderType||"v",this.type="slider",this._opts=e;var h=r+a/2,c=t.g({class:d}),l=c.insert("rect",{class:d+"__value",rx:h,ry:h,x:n-a/2,y:o-a/2,width:s+a,height:i+a,strokeWidth:a,stroke:e.border.color});l.setGradient("fill",t.gradient("linear",{0:{color:"#000"},100:{color:"#fff"}})),this._gradient=l.gradient,this.marker=new u(c,e.marker)};b.prototype.update=function(t,e){var r=this._opts,s=r.range,i=t.hsv,n=m.hsv2Hsl({h:i.h,s:i.s,v:100});if("v"==r.sliderType&&((e.h||e.s)&&this._gradient.stops[1].setAttrs({stopColor:"hsl("+n.h+","+n.s+"%,"+n.l+"%)"}),e.v)){var o=i.v/100;this.marker.move(s.min+o*s.w,r.y+r.h/2)}},b.prototype.input=function(t,e){var r=this._opts.range,s=Math.max(Math.min(t,r.max),r.min)-r.min;return{v:Math.round(100/r.w*s)}},b.prototype.checkHit=function(t,e){var r=this._opts;return t>r.x&&t<r.x+r.w&&e>r.y&&e<r.y+r.h};var h=0,_="Gradient",w={class:"class",stroke:"stroke",strokeWidth:"stroke-width",fill:"fill",opacity:"opacity",offset:"offset",stopColor:"stop-color",stopOpacity:"stop-opacity"},k={translate:"setTranslate",scale:"setScale",rotate:"setRotate"},e=window.navigator.userAgent.toLowerCase(),S=/msie|trident|edge/.test(e),x=/^((?!chrome|android).)*safari/i.test(e),M=function(t,e,r,s){var i=document.createElementNS("http://www.w3.org/2000/svg",r);this.el=i,this.setAttrs(s),(e.el||e).appendChild(i),this._root=t,this._svgTransforms={},this._transformList=!!i.transform&&i.transform.baseVal};M.prototype.insert=function(t,e){return new M(this._root,this,t,e)},M.prototype.g=function(t){return this.insert("g",t)},M.prototype.arc=function(t,e,r,s,i,n){var o=i-s<=180?0:1;s*=Math.PI/180,i*=Math.PI/180;var a=t+r*Math.cos(i),h=e+r*Math.sin(i),c=t+r*Math.cos(s),l=e+r*Math.sin(s);return(n=n||{}).d=["M",a,h,"A",r,r,0,o,0,c,l].join(" "),this.insert("path",n)},M.prototype.circle=function(t,e,r,s){return(s=s||{}).cx=t,s.cy=e,s.r=r,this.insert("circle",s)},M.prototype.setTransform=function(t,e){if(S)this.setAttrs({transform:t+"("+e.join(", ")+")"});else{var r,s=this._svgTransforms;s[t]?r=s[t]:(r=this._root.el.createSVGTransform(),s[t]=r,this._transformList.appendItem(r)),r[t in k?k[t]:t].apply(r,e)}},M.prototype.setAttrs=function(t){for(var e in t){var r=e in w?w[e]:e;this.el.setAttribute(r,t[e])}},M.prototype.setGradient=function(t,e){var r={};r[t]=e.getUrl(),(e._refs[t]=this).gradient=e,this.setAttrs(r)};var C=function(t,e,r){var s=[],i=t._defs.insert(e+_,{id:"iro"+_+h++});for(var n in r){var o=r[n];s.push(i.insert("stop",{offset:n+"%",stopColor:o.color,stopOpacity:void 0===o.opacity?1:o.opacity}))}this.el=i.el,this.stops=s,this._refs={}};C.prototype.getUrl=function(t){return"url("+(x?t||location.protocol+"//"+location.host+location.pathname:"")+"#"+this.el.id+")"};var T=function(i){function t(t,e,r,s){i.call(this,null,t,"svg",{width:e,height:r,style:"display:"+(s||"block")+";touch-action:none"}),(this._root=this)._defs=this.insert("defs"),this._gradients=[]}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.gradient=function(t,e){var r=new C(this,t,e);return this._gradients.push(r),r},t.prototype.updateUrls=function(t){if(x)for(var e=this._gradients,r=0;r<e.length;r++)for(var s in e[r]._refs){var i={};i[s]=e[r].getUrl(t),e[r]._refs[s].setAttrs(i)}},t}(M),H=function(){var t=document.createElement("style");document.head.appendChild(t),t.appendChild(document.createTextNode(""));var e=(this.style=t).sheet;this.sheet=e,this.rules=e.rules||e.cssRules,this.map={}},A={enabled:{configurable:!0},cssText:{configurable:!0},css:{configurable:!0}};A.enabled.get=function(){return!this.sheet.disabled},A.enabled.set=function(t){this.sheet.disabled=!t},A.cssText.get=function(){var t=this.map,e=[];for(var r in t)e.push(r.replace(/,\W/g,",\n")+" {\n\t"+t[r].cssText.replace(/;\W/g,";\n\t")+"\n}");return e.join("\n")},A.css.get=function(){var t=this.map,e={};for(var r in t){var s=t[r];e[r]={};for(var i=0;i<s.length;i++){var n=s[i];e[r][n]=s.getPropertyValue(n)}}return e},H.prototype.setRule=function(e,t,r){var s=this.sheet,i=s.rules||s.cssRules,n=this.map;if(t=t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()}),n.hasOwnProperty(e))n[e].setProperty(t,r);else{var o=i.length,a=t+": "+r;try{s.insertRule(e+" {"+a+";}",o)}catch(t){s.addRule(e,a,o)}finally{i=s.rules||s.cssRules,n[e]=i[o].style}}},Object.defineProperties(H.prototype,A);var R="mousedown",I="mousemove",P="mouseup",W="touchstart",j="touchmove",L="touchend",O="readystatechange",X="complete";function Y(t,e,r,s){void 0===s&&(s={});for(var i=0;i<e.length;i++)t.addEventListener(e[i],r,s)}function E(t,e,r){for(var s=0;s<e.length;s++)t.removeEventListener(e[s],r)}var G=function(t,e){var r,s=this;e=e||{},this._events={},this._mouseTarget=!1,this._colorChangeActive=!1,this.css=e.css||e.styles||void 0,r=function(){s._mount(t,e)},document.readyState==X?r():Y(document,[O],function t(e){document.readyState==X&&(r(),E(document,[O],t))})};return G.prototype._mount=function(t,e){var r=this;t="string"==typeof t?document.querySelector(t):t;var s=parseInt(getComputedStyle(t).width),i=parseInt(getComputedStyle(t).height);i<s&&0!=i?s=i:0!=s&&(i=s);var n=e.width||s||320,o=e.height||i||320,a=e.padding+2||6,h=e.borderWidth||0,c=e.markerRadius||8,l=e.sliderMargin||24,u=e.sliderHeight||2*c+2*a+2*h,f=Math.min(o-u-l,n),p=f/2-h,v=(n-f)/2,g={r:c},d={w:h,color:e.borderColor||"#fff"};this.el=t,this.svg=new T(t,n,o,e.display),this.ui=[new y(this.svg,{cX:v+f/2,cY:f/2,r:p,rMax:p-(c+a),marker:g,border:d,lightness:null==e.wheelLightness||e.wheelLightness,anticlockwise:e.anticlockwise}),new b(this.svg,{sliderType:"v",x:v+h,y:f+l,w:f-2*h,h:u-2*h,r:u/2-h,marker:g,border:d})],this.stylesheet=new H,this.color=new m,this.color._onChange=this._update.bind(this),this.color.set(e.color||e.defaultValue||"#fff"),this.on("history:stateChange",function(t){r.svg.updateUrls(t)}),Y(this.svg.el,[R,W],this,{passive:!1}),this.emit("mount",this)},G.prototype._update=function(t,e){for(var r=t.rgbString,s=this.css,i=0;i<this.ui.length;i++)this.ui[i].update(t,e);for(var n in s){var o=s[n];for(var a in o)this.stylesheet.setRule(n,a,r)}this._colorChangeActive||(this._colorChangeActive=!0,this.emit("color:change",t,e),this._colorChangeActive=!1)},G.prototype.on=function(t,e){var r=this._events;(r[t]||(r[t]=[])).push(e)},G.prototype.off=function(t,e){var r=this._events[t];r&&r.splice(r.indexOf(e),1)},G.prototype.emit=function(t){for(var e=[],r=arguments.length-1;0<r--;)e[r]=arguments[r+1];for(var s=this._events,i=(s[t]||[]).concat(s["*"]||[]),n=0;n<i.length;n++)i[n].apply(null,e)},G.prototype.handleEvent=function(t){var e=this,r=t.touches?t.changedTouches[0]:t,s=this.svg.el.getBoundingClientRect(),i=r.clientX-s.left,n=r.clientY-s.top;switch(t.type){case R:case W:for(var o=0;o<this.ui.length;o++){var a=e.ui[o];a.checkHit(i,n)&&(e._mouseTarget=a,Y(document,[I,j,P,L],e,{passive:!1}),e.emit("input:start",e.color),e.color.hsv=e._mouseTarget.input(i,n))}break;case I:case j:this.color.hsv=this._mouseTarget.input(i,n);break;case P:case L:this._mouseTarget=!1,this.emit("input:end",this.color),E(document,[I,j,P,L],this)}this._mouseTarget&&t.preventDefault()},{Color:m,ColorPicker:G,Stylesheet:H,version:"3.5.2"}});