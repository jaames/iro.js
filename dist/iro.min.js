/*!
 * iro.js v4.0.0-beta
 * 2016-2018 James Daniel
 * Released under the MIT License
 * github.com/jaames/iro.js
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.iro=e()}(this,function(){"use strict";var t=function(t,e){var r=t.g({class:"iro__handle"});r.circle(0,0,e.r,{class:"iro__handle__outer",fill:"none",strokeWidth:5,stroke:"#000"}),r.circle(0,0,e.r,{class:"iro__handle__inner",fill:"none",strokeWidth:2,stroke:"#fff"}),this.g=r};t.prototype.move=function(t,e){this.g.setTransform("translate",[t,e])};var e="readystatechange",r="complete";function s(t,e,r,s){void 0===s&&(s={});for(var n=0;n<e.length;n++)t.addEventListener(e[n],r,s)}function n(t,e,r){for(var s=0;s<e.length;s++)t.removeEventListener(e[s],r)}var i=function(t,e){var r=t.svg.g({class:e}),n=r.el;s(n,["mousedown","touchstart"],this,{passive:!1}),this.g=r,this.el=n,this.parent=t};i.prototype.handleEvent=function(t){t.preventDefault();var e,r=t.touches?t.changedTouches[0]:t,i=this.el.getBoundingClientRect(),o=r.clientX-i.left,a=r.clientY-i.top,h=this.parent.color;switch(t.type){case"mousedown":case"touchstart":s(document,["mousemove","touchmove","mouseup","touchend"],this,{passive:!1}),e=this.input(o,a,"START"),this.parent.emit("input:start",h);break;case"mousemove":case"touchmove":e=this.input(o,a,"MOVE");break;case"mouseup":case"touchend":e=this.input(o,a,"END"),this.parent.emit("input:end",h),n(document,["mousemove","touchmove","mouseup","touchend"],this)}e&&(h.hsv=e)};var o="iro__wheel",a=Math.PI,h=Math.sqrt,c=Math.round,l=function(e){function r(r,s){e.call(this,r,o),this._opts=s,this.type="wheel";var n=s.cY,i=s.cX,a=s.r,h=s.border,c=r.svg,l=this.g;l.circle(i,n,a+h.w/2,{class:o+"__border",fill:"#fff",stroke:h.color,strokeWidth:h.w});for(var u=l.g({class:o+"__hue",strokeWidth:a,fill:"none"}),p=0;p<360;p++)u.arc(i,n,a/2,p,p+1.5,{stroke:"hsl("+(s.anticlockwise?360-p:p)+",100%,50%)"});l.circle(i,n,a,{class:o+"__saturation"}).setGradient("fill",c.gradient("radial",{0:{color:"#fff"},100:{color:"#fff",opacity:0}})),this._lightness=l.circle(i,n,a,{class:o+"__lightness",opacity:0}),this.handle=new t(l,s.marker)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.update=function(t,e){var r=this._opts,s=t.hsv;if(e.v&&r.lightness&&this._lightness.setAttrs({opacity:(1-s.v/100).toFixed(2)}),e.h||e.s){var n=(r.anticlockwise?360-s.h:s.h)*(a/180),i=s.s/100*r.rMax;this.handle.move(r.cX+i*Math.cos(n),r.cY+i*Math.sin(n))}},r.prototype.input=function(t,e){var r=this._opts,s=r.rMax;t=r.r-t,e=r.r-e;var n=Math.atan2(e,t),i=c(n*(180/a))+180,o=Math.min(h(t*t+e*e),s);return{h:i=r.anticlockwise?360-i:i,s:c(100/s*o)}},r}(i),u=Math.round,p=Math.floor;function f(t,e){var r=t.match(/(\S+)\((\d+)(%?)(?:\D+?)(\d+)(%?)(?:\D+?)(\d+)(%?)(?:\D+?)?([0-9\.]+?)?\)/i),s=parseInt(r[2]),n=parseInt(r[4]),i=parseInt(r[6]);return[r[1],"%"==r[3]?s/100*e[0]:s,"%"==r[5]?n/100*e[1]:n,"%"==r[7]?i/100*e[2]:i,parseFloat(r[8])||void 0]}function v(t){return t instanceof y?t:new y(t)}function g(t,e,r){return t<=e?e:t>=r?r:t}function d(t,e){var r={};for(var s in t)r[s]=e[s]!=t[s];return r}var y=function(t){this._onChange=!1,this._value={h:void 0,s:void 0,v:void 0},t&&this.set(t)},_={hsv:{configurable:!0},rgb:{configurable:!0},hsl:{configurable:!0},rgbString:{configurable:!0},hexString:{configurable:!0},hslString:{configurable:!0}};y.mix=function(t,e,r){var s=v(t).rgb,n=v(e).rgb;return r=g(r/100||.5,0,1),new y({r:p(s.r+(n.r-s.r)*r),g:p(s.g+(n.g-s.g)*r),b:p(s.b+(n.b-s.b)*r)})},y.lighten=function(t,e){var r=v(t),s=r.hsv;return s.v=g(s.v+e,0,100),r.hsv=s,r},y.darken=function(t,e){var r=v(t),s=r.hsv;return s.v=g(s.v-e,0,100),r.hsv=s,r},y.hsv2Rgb=function(t){var e,r,s,n,i,o,a,h,c=t.h/360,l=t.s/100,f=t.v/100;switch(o=f*(1-l),a=f*(1-(i=6*c-(n=p(6*c)))*l),h=f*(1-(1-i)*l),n%6){case 0:e=f,r=h,s=o;break;case 1:e=a,r=f,s=o;break;case 2:e=o,r=f,s=h;break;case 3:e=o,r=a,s=f;break;case 4:e=h,r=o,s=f;break;case 5:e=f,r=o,s=a}return{r:u(255*e),g:u(255*r),b:u(255*s)}},y.rgb2Hsv=function(t){var e,r=t.r/255,s=t.g/255,n=t.b/255,i=Math.max(r,s,n),o=Math.min(r,s,n),a=i-o;switch(i){case o:e=0;break;case r:e=(s-n)/a+(s<n?6:0);break;case s:e=(n-r)/a+2;break;case n:e=(r-s)/a+4}return{h:360*(e/=6),s:0==i?0:a/i*100,v:100*i}},y.hsv2Hsl=function(t){var e=t.s/100,r=t.v/100,s=.5*r*(2-e);return e=r*e/(1-Math.abs(2*s-1)),{h:t.h,s:100*e||0,l:100*s}},y.hsl2Hsv=function(t){var e=t.s/100,r=t.l/100;return e*=(r*=2)<=1?r:2-r,{h:t.h,s:2*e/(r+e)*100,v:(r+e)/2*100}},y.hsl2Str=function(t){return"hsl"+(t.a?"a":"")+"("+t.h+", "+t.s+"%, "+t.l+"%"+(t.a?", "+t.a:"")+")"},y.rgb2Str=function(t){return"rgb"+(t.a?"a":"")+"("+t.r+", "+t.g+", "+t.b+(t.a?", "+t.a:"")+")"},y.rgb2Hex=function(t){var e="#";return e+=t.r.toString(16).padStart(2,"0"),e+=t.g.toString(16).padStart(2,"0"),e+=t.b.toString(16).padStart(2,"0")},y.parseHexStr=function(t){t=t.replace("#","");var e=parseInt("0x"+t),r=3==t.length,s=r?15:255,n=r?4:8,i=r?17:1;return{r:(e>>2*n&s)*i,g:(e>>n&s)*i,b:(e&s)*i}},y.parseHslStr=function(t){var e=f(t,[360,100,100]);return{h:e[2],s:e[3],l:e[4]}},y.parseRgbStr=function(t){var e=f(t,[255,255,255]);return{r:e[1],g:e[2],b:e[3]}},_.hsv.get=function(){var t=this._value;return{h:t.h,s:t.s,v:t.v}},_.hsv.set=function(t){if(this._onChange){var e=this._value;for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r]);var s=d(e,t);this._value=t,(s.h||s.s||s.v)&&this._onChange(this,s)}else this._value=t},_.rgb.get=function(){var t=y.hsv2Rgb(this._value);return{r:u(t.r),g:u(t.g),b:u(t.b)}},_.rgb.set=function(t){this.hsv=y.rgb2Hsv(t)},_.hsl.get=function(){var t=y.hsv2Hsl(this._value);return{h:u(t.h),s:u(t.s),l:u(t.l)}},_.hsl.set=function(t){this.hsv=y.hsl2Hsv(t)},_.rgbString.get=function(){return y.rgb2Str(this.rgb)},_.rgbString.set=function(t){this.rgb=y.parseRgbStr(t)},_.hexString.get=function(){return y.rgb2Hex(this.rgb)},_.hexString.set=function(t){this.rgb=y.parseHexStr(t)},_.hslString.get=function(){return y.hsl2Str(this.hsl)},_.hslString.set=function(t){this.hsl=y.parseHslStr(t)},y.prototype.set=function(t){"object"==typeof t?t instanceof y?this.hsv=y._value:"r"in t?this.rgb=t:"v"in t?this.hsv=t:"l"in t&&(this.hsl=t):"string"==typeof t&&(/^rgb/.test(t)?this.rgbString=t:/^hsl/.test(t)?this.hslString=t:/^#[0-9A-Fa-f]/.test(t)&&(this.hexString=t))},y.prototype.setChannel=function(t,e,r){var s=this[t];s[e]=r,this[t]=s},y.prototype.clone=function(){return new y(this)},y.prototype.compare=function(t,e){return d(this[e=e||"hsv"],v(t)[e])},y.prototype.mix=function(t,e){this.hsv=t.mix(this,t,e).hsv},y.prototype.lighten=function(t){y.lighten(this,t)},y.prototype.darken=function(t){y.darken(this,t)},Object.defineProperties(y.prototype,_);var b="iro__slider",m=function(e){function r(r,s){e.call(this,r,b);var n=r.svg,i=s.r,o=s.w,a=s.h,h=s.x,c=s.y,l=s.border.w;s.range={min:i,max:o-i,w:o-2*i},s.sliderType=s.sliderType||"v",this.type="slider",this._opts=s;var u=this.g,p=i+l/2,f=u.insert("rect",{class:b+"__value",rx:p,ry:p,x:h-l/2,y:c-l/2,width:o+l,height:a+l,strokeWidth:l,stroke:s.border.color});f.setGradient("fill",n.gradient("linear",{0:{color:"#000"},100:{color:"#fff"}})),this._gradient=f.gradient,this.handle=new t(u,s.marker)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.update=function(t,e){var r=this._opts,s=r.range,n=t.hsv,i=y.hsv2Hsl({h:n.h,s:n.s,v:100});if("v"==r.sliderType&&((e.h||e.s)&&this._gradient.stops[1].setAttrs({stopColor:"hsl("+i.h+","+i.s+"%,"+i.l+"%)"}),e.v)){var o=n.v/100;this.handle.move(r.x+r.r+o*s.w,r.y+r.h/2)}},r.prototype.input=function(t,e,r){var s=this._opts.range,n=Math.max(Math.min(t,s.max),s.min)-s.min;return{v:Math.round(100/s.w*n)}},r}(i),w=0,k={class:"class",stroke:"stroke",strokeWidth:"stroke-width",fill:"fill",opacity:"opacity",offset:"offset",stopColor:"stop-color",stopOpacity:"stop-opacity"},S={translate:"setTranslate",scale:"setScale",rotate:"setRotate"},x=window.navigator.userAgent.toLowerCase(),M=/msie|trident|edge/.test(x),C=/^((?!chrome|android).)*safari/i.test(x),T=function(t,e,r,s){var n=document.createElementNS("http://www.w3.org/2000/svg",r);this.el=n,this.setAttrs(s),(e.el||e).appendChild(n),this._root=t,this._svgTransforms={},this._transformList=!!n.transform&&n.transform.baseVal};T.prototype.insert=function(t,e){return new T(this._root,this,t,e)},T.prototype.g=function(t){return this.insert("g",t)},T.prototype.arc=function(t,e,r,s,n,i){var o=n-s<=180?0:1;s*=Math.PI/180,n*=Math.PI/180;var a=t+r*Math.cos(n),h=e+r*Math.sin(n),c=t+r*Math.cos(s),l=e+r*Math.sin(s);return(i=i||{}).d=["M",a,h,"A",r,r,0,o,0,c,l].join(" "),this.insert("path",i)},T.prototype.circle=function(t,e,r,s){return(s=s||{}).cx=t,s.cy=e,s.r=r,this.insert("circle",s)},T.prototype.setTransform=function(t,e){if(M)this.setAttrs({transform:t+"("+e.join(", ")+")"});else{var r,s=this._svgTransforms;s[t]?r=s[t]:(r=this._root.el.createSVGTransform(),s[t]=r,this._transformList.appendItem(r)),r[t in S?S[t]:t].apply(r,e)}},T.prototype.setAttrs=function(t){for(var e in t){var r=e in k?k[e]:e;this.el.setAttribute(r,t[e])}},T.prototype.setGradient=function(t,e){var r={};r[t]=e.getUrl(),e._refs[t]=this,this.gradient=e,this.setAttrs(r)};var A=function(t,e,r){var s=[],n=t._defs.insert(e+"Gradient",{id:"iroGradient"+w++});for(var i in r){var o=r[i];s.push(n.insert("stop",{offset:i+"%",stopColor:o.color,stopOpacity:void 0===o.opacity?1:o.opacity}))}this.el=n.el,this.stops=s,this._refs={}};A.prototype.getUrl=function(t){return"url("+(C?t||window.location.href:"")+"#"+this.el.id+")"};var R=function(t){function e(e,r,s,n){t.call(this,null,e,"svg",{width:r,height:s,style:"display:"+(n||"block")+";touch-action:none"}),this._root=this,this._defs=this.insert("defs"),this._gradients=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.gradient=function(t,e){var r=new A(this,t,e);return this._gradients.push(r),r},e.prototype.updateUrls=function(t){if(C)for(var e=this._gradients,r=0;r<e.length;r++)for(var s in e[r]._refs){var n={};n[s]=e[r].getUrl(t),e[r]._refs[s].setAttrs(n)}},e}(T),H=function(){var t=document.createElement("style");document.head.appendChild(t),t.appendChild(document.createTextNode("")),this.style=t;var e=t.sheet;this.sheet=e,this.rules=e.rules||e.cssRules,this.map={}},O={enabled:{configurable:!0},cssText:{configurable:!0},css:{configurable:!0}};H.prototype.setRule=function(t,e,r){var s=this.sheet,n=s.rules||s.cssRules,i=this.map;if(e=e.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()}),i.hasOwnProperty(t))i[t].setProperty(e,r);else{var o=n.length,a=e+": "+r;try{s.insertRule(t+" {"+a+";}",o)}catch(e){s.addRule(t,a,o)}finally{n=s.rules||s.cssRules,i[t]=n[o].style}}},O.enabled.get=function(){return!this.sheet.disabled},O.enabled.set=function(t){this.sheet.disabled=!t},O.cssText.get=function(){var t=this.map,e=[];for(var r in t)e.push(r.replace(/,\W/g,",\n")+" {\n\t"+t[r].cssText.replace(/;\W/g,";\n\t")+"\n}");return e.join("\n")},O.css.get=function(){var t=this.map,e={};for(var r in t){var s=t[r];e[r]={};for(var n=0;n<s.length;n++){var i=s[n];e[r][i]=s.getPropertyValue(i)}}return e},Object.defineProperties(H.prototype,O);var j=function(t,i){var o,a=this;i=i||{},this._events={},this._mouseTarget=!1,this._colorChangeActive=!1,this.css=i.css||i.styles||void 0,o=function(){a._mount(t,i)},document.readyState==r?o():s(document,[e],function t(s){document.readyState==r&&(o(),n(document,[e],t))})};return j.prototype._mount=function(t,e){var r=this;t="string"==typeof t?document.querySelector(t):t;var s=e.width||parseInt(t.width)||320,n=e.height||parseInt(t.height)||320,i=e.padding+2||6,o=e.borderWidth||0,a=e.markerRadius||8,h=e.sliderMargin||24,c=e.sliderHeight||2*a+2*i+2*o,u=Math.min(n-c-h,s),p=u/2-o,f=(s-u)/2,v={r:a},g={w:o,color:e.borderColor||"#fff"};this.el=t,this.svg=new R(t,s,n,e.display),this.ui=[new l(this,{cX:f+u/2,cY:u/2,r:p,rMax:p-(a+i),marker:v,border:g,lightness:void 0==e.wheelLightness||e.wheelLightness,anticlockwise:e.anticlockwise}),new m(this,{sliderType:"v",x:f+o,y:u+h,w:u-2*o,h:c-2*o,r:c/2-o,marker:v,border:g})],this.stylesheet=new H,this.color=new y,this.color._onChange=this._update.bind(this),this.color.set(e.color||e.defaultValue||"#fff"),this.on("history:stateChange",function(t){r.svg.updateUrls(t)}),this.emit("mount",this)},j.prototype._update=function(t,e){for(var r=t.rgbString,s=this.css,n=0;n<this.ui.length;n++)this.ui[n].update(t,e);for(var i in s){var o=s[i];for(var a in o)this.stylesheet.setRule(i,a,r)}this._colorChangeActive||(this._colorChangeActive=!0,this.emit("color:change",t,e),this._colorChangeActive=!1)},j.prototype.on=function(t,e){var r=this._events;(r[t]||(r[t]=[])).push(e)},j.prototype.off=function(t,e){var r=this._events[t];r&&r.splice(r.indexOf(e),1)},j.prototype.emit=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var s=this._events,n=(s[t]||[]).concat(s["*"]||[]),i=0;i<n.length;i++)n[i].apply(null,e)},{Color:y,ColorPicker:j,Stylesheet:H,version:"4.0.0-beta"}});
//# sourceMappingURL=iro.min.js.map
